(function(e){function t(t){for(var o,i,c=t[0],d=t[1],s=t[2],l=0,f=[];l<c.length;l++)i=c[l],r[i]&&f.push(r[i][0]),r[i]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,c=1;c<n.length;c++){var d=n[c];0!==r[d]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=d;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("04f5"),r=n.n(o);r.a},"04f5":function(e,t,n){},"054e":function(e,t,n){},"0ba7":function(e,t,n){"use strict";var o=n("054e"),r=n.n(o);r.a},"175c":function(e,t,n){},"194f":function(e,t,n){"use strict";var o=n("eafc"),r=n.n(o);r.a},"206f":function(e,t,n){"use strict";var o=n("a9ff"),r=n.n(o);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("EditorComponent")],1)},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"editor"}},[n("TabComponent")],1)},c=[],d=n("c93e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tab"},e._l(e.sections,function(t,o){return n("div",{key:o},[n("div",{staticClass:"tab-block"},[n("div",[n("button",{on:{click:function(t){e.queueAddSection(o)}}},[e._v("+")])]),n("div",[e.sectionCount>1?n("button",{on:{click:function(n){e.queueRemoveSection(t.id)}}},[e._v("x")]):e._e()]),n("div",[n("button",{on:{click:function(t){e.queueAddSection(o+1)}}},[e._v("+")])])]),n("SectionComponent",{staticClass:"tab-block",attrs:{id:t.id}})],1)}))},u=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"-block",attrs:{id:"section"}},e._l(e.barsOfSection(e.id),function(t,o){return n("div",{key:o,staticClass:"section-block"},[n("div",{attrs:{id:"bar-control"}},[n("Button",{on:{click:function(t){e.queueAddBar({parentId:e.id,index:o})}}},[e._v("+")]),e.sectionCount>1||e.barCountOfSection(e.id)>1?n("Button",{on:{click:function(n){e.handleDeletion(t.id)}}},[e._v("X")]):e._e(),n("Button",{on:{click:function(t){e.queueAddBar({parentId:e.id,index:o+1})}}},[e._v("+")])],1),n("BarComponent",{staticClass:"section-block",attrs:{id:t.id}}),e.isLastBar(t.id)?n("svg",{staticClass:"section-block",attrs:{width:"4",height:"145"}},[n("rect",{staticStyle:{fill:"black"},attrs:{x:"0",y:"10",width:"4",height:"126"}})]):e._e()],1)}))},f=[],p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{width:"320",height:"145"}},[n("rect",{staticStyle:{fill:"black"},attrs:{x:"0",y:"10",width:"1",height:"125"}}),e._l(e.tuning,function(e,t){return n("g",{key:e},[n("rect",{staticStyle:{fill:"black"},attrs:{x:"0",y:25*t+10,width:"320",height:"1"}})])}),e._l(e.beatsOfBar(e.id),function(e,t){return n("BeatComponent",{key:t,attrs:{id:e.id,xIndex:t}})}),n("rect",{staticStyle:{fill:"black"},attrs:{x:"319",y:"10",width:"1",height:"125"}})],2)},b=[],v=new o["a"],h=v,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{attrs:{id:"beat"}},e._l(e.notesOfBeat(e.id),function(t,o){return n("g",{key:o,on:{click:[function(n){if(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)return null;e.selectSingle(t.id)},function(n){return n.ctrlKey?n.shiftKey||n.altKey||n.metaKey?null:void e.selectMulti(t.id):null},function(n){return n.metaKey?n.ctrlKey||n.shiftKey||n.altKey?null:void e.selectMulti(t.id):null}],mouseover:function(e){e.target.classList.add("hovered")},mouseout:function(e){e.target.classList.remove("hovered")}}},[n("rect",{class:{selected:e.isNoteSelected(t.id)},attrs:{x:64*e.xIndex+64-9,y:25*o+10-9,width:"18",height:"18",rx:"5",ry:"5",fill:"white"}}),n("text",{staticClass:"tab-text",attrs:{x:64*e.xIndex+64,y:25*o+10,"alignment-baseline":"middle"}},[e._v("\n      "+e._s(t.note)+"\n    ")])])}))},m=[],S=(n("ac4d"),n("8a81"),n("ac6a"),n("c5f6"),n("2f62")),k={name:"Beat",props:{id:String,xIndex:Number},computed:Object(d["a"])({},Object(S["c"])("tab",["notesOfBeat","note","isNoteSelected","getNoteSelectionsOfBeat"])),created:function(){document.addEventListener("keydown",this.onKeyPress)},destroyed:function(){document.removeEventListener("keydown",this.onKeyPress)},methods:Object(d["a"])({},Object(S["d"])("tab",["selectNote","deselectNote","clearNoteSelections"]),Object(S["b"])("tab",["queueNote"]),{onKeyPress:function(e){if(0!==this.getNoteSelectionsOfBeat(this.id).length){if(e.keyCode>=48&&e.keyCode<=57){e.preventDefault();var t=e.keyCode-48;this.appendSelections(t)}8!==e.keyCode&&46!==e.keyCode||(e.preventDefault(),this.backspaceSelections()),27===e.keyCode&&(e.preventDefault(),this.clearNoteSelections())}},selectSingle:function(e){this.clearNoteSelections(),this.selectNote(e)},selectMulti:function(e){this.isNoteSelected(e)?this.deselectNote(e):this.selectNote(e)},appendSelections:function(e){var t=this.getNoteSelectionsOfBeat(this.id),n=!0,o=!1,r=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value,d=this.note(c).note;this.queueNote({mutation:"replaceNote",payload:{id:c,value:d.length<2?d+e:d}})}}catch(e){o=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}},backspaceSelections:function(){var e=this.getNoteSelectionsOfBeat(this.id),t=!0,n=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var i=r.value,c=this.note(i).note;this.queueNote({mutation:"replaceNote",payload:{id:i,value:c.length>0?c.slice(0,-1):c}})}}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}}})},g=k,I=(n("194f"),n("2877")),x=Object(I["a"])(g,y,m,!1,null,"1693ba70",null),O=x.exports,B={name:"Bar",components:{BeatComponent:O},props:{id:String},computed:Object(d["a"])({},Object(S["e"])("tab",["tuning"]),Object(S["c"])("tab",["beatsOfBar","isLastBar"])),data:function(){return{hovered:!1}}},C=B,w=(n("74f7"),Object(I["a"])(C,p,b,!1,null,"4dcead9c",null)),j=w.exports,_={name:"Section",props:{id:String},components:{BarComponent:j},computed:Object(d["a"])({},Object(S["c"])("tab",["barsOfSection","barCountOfSection","sectionCount","isLastBar"])),methods:Object(d["a"])({},Object(S["b"])("tab",["queueAddBar","queueRemoveBar","queueRemoveSection"]),{handleDeletion:function(e){1===this.barCountOfSection(this.id)?this.queueRemoveSection(this.id):this.queueRemoveBar(e)}})},R=_,N=(n("206f"),Object(I["a"])(R,l,f,!1,null,"a36de34c",null)),K=N.exports,q={name:"Tab",components:{SectionComponent:K},computed:Object(d["a"])({},Object(S["c"])("tab",["sections","sectionCount"])),data:function(){return{}},mounted:function(){h.$on("undo",this.undo),h.$on("redo",this.redo)},methods:Object(d["a"])({},Object(S["b"])("tab",["queueAddSection","queueRemoveSection"]))},D=q,E=(n("0ba7"),Object(I["a"])(D,s,u,!1,null,"7fbeef09",null)),P=E.exports,U={name:"Editor",components:{TabComponent:P},computed:Object(d["a"])({},Object(S["c"])("tab",["canUndo","canRedo"])),created:function(){document.addEventListener("keydown",this.onKeyPress)},destroyed:function(){document.removeEventListener("keydown",this.onKeyPress)},methods:Object(d["a"])({},Object(S["b"])("tab",["undo","redo"]),{onKeyPress:function(e){-1!=navigator.appVersion.indexOf("Mac")&&(e.metaKey&&90===e.keyCode?(e.preventDefault(),this.canUndo&&this.undo()):e.metaKey&&89===e.keyCode&&(e.preventDefault(),this.canRedo&&this.redo())),e.ctrlKey&&90===e.keyCode?(e.preventDefault(),this.canUndo&&this.undo()):e.ctrlKey&&89===e.keyCode&&(e.preventDefault(),this.canRedo&&this.redo())}})},T=U,$=(n("781d"),Object(I["a"])(T,i,c,!1,null,null,null)),A=$.exports,L={name:"app",components:{EditorComponent:A},mounted:function(){document.onclick=function(e){var t="target"in e?e.target:e.srcElement;h.$emit("mouse-click",t)},document.onkeydown=function(e){e=e||window.event,e.shiftKey&&9===e.keyCode?(e.preventDefault(),h.$emit("nav-left")):9===e.keyCode&&(e.preventDefault(),h.$emit("nav-right")),e.shiftKey&&13===e.keyCode?(e.preventDefault(),h.$emit("nav-up")):13===e.keyCode&&(e.preventDefault(),h.$emit("nav-down"))}}},M=L,G=(n("034f"),Object(I["a"])(M,r,a,!1,null,null,null)),V=G.exports,J=(n("34ef"),n("6b54"),n("a481"),n("456d"),n("6762"),n("2fdb"),{undoStack:[],redoStack:[],changes:[],noteSelections:[],selectionPointer:0}),X={isNoteSelected:function(e){return function(t){return e.noteSelections.includes(t)}},getNoteSelectionsOfBeat:function(e,t){return function(n){var o=t.beat(n).notes;return e.noteSelections.filter(function(e){return o.includes(e)})}},canUndo:function(e){return 0!==e.undoStack.length},canRedo:function(e){return 0!==e.redoStack.length}},z={selectNote:function(e,t){e.noteSelections.push(t)},deselectNote:function(e,t){var n=e.noteSelections.indexOf(t);o["a"].delete(e.noteSelections,n)},clearNoteSelections:function(e){e.noteSelections=[]},pushToUndoStack:function(e,t){e.undoStack.push(t)},pushToRedoStack:function(e,t){e.redoStack.push(t)},clearRedoStack:function(e,t){var n=!0,o=!1,r=void 0;try{for(var a,i=e.redoStack[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value;"removeBar"===c.type&&t("deleteBar",c.id),"removeSection"===c.type&&t("deleteSection",c.id)}}catch(e){o=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}e.redoStack=[]}},F={commitNotes:function(e,t,n){var o=!0,r=!1,a=void 0;try{for(var i,c=t.changes[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var d=i.value,s=n.note(d.payload.id).note;e(d.mutation,d.payload),d.payload.value=s}}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}0!==t.changes.length&&(e("pushToUndoStack",{type:"noteEdited",notes:t.changes}),e("clearRedoStack",e),t.changes=[])},revertChange:function(e,t,n){switch(n.type){case"removeBar":e("addBarReference",{parentId:n.parentId,index:n.index,barId:n.id}),n.type="addBar";break;case"addBar":e("removeBarReference",{parentId:n.parentId,index:n.index}),n.type="removeBar";break;case"addSection":e("removeSectionReference",n.index),n.type="removeSection";break;case"removeSection":e("addSectionReference",{index:n.index,sectionId:n.id}),n.type="addSection";break;case"noteEdited":var o=!0,r=!1,a=void 0;try{for(var i,c=n.notes[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var d=i.value,s=t.note(d.payload.id).note;e(d.mutation,d.payload),d.payload.value=s}}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}break;default:break}}},H={queueNote:function(e,t){var n=e.commit,o=e.state,r=e.getters;t.payload.value!==r.note(t.payload.id).note&&o.changes.push(t),o.selectionPointer++,o.selectionPointer===o.noteSelections.length&&(F.commitNotes(n,o,r),o.selectionPointer=0)},queueAddBar:function(e,t){var n=e.commit,o=e.getters;n("addBar",t);var r=o.barIdViaSectionIndex({parentId:t.parentId,index:t.index});n("pushToUndoStack",{type:"addBar",parentId:t.parentId,index:t.index,id:r}),n("clearRedoStack",n)},queueRemoveBar:function(e,t){var n=e.commit,o=e.getters,r=o.barParent(t),a=r.bars.indexOf(t);n("removeBarReference",{parentId:r.id,index:a}),n("pushToUndoStack",{type:"removeBar",parentId:r.id,index:a,id:t}),n("clearRedoStack",n)},queueAddSection:function(e,t){var n=e.commit,o=e.getters;n("addSection",t);var r=o.sectionIdViaTabIndex(t);n("pushToUndoStack",{type:"addSection",id:r,index:t}),n("clearRedoStack",n)},queueRemoveSection:function(e,t){var n=e.commit,o=e.getters,r=o.sectionIndex(t);n("removeSectionReference",r),n("pushToUndoStack",{type:"removeSection",index:r,id:t}),n("clearRedoStack",n)},undo:function(e){var t=e.commit,n=e.state,o=e.getters,r=n.undoStack.pop();F.revertChange(t,o,r),t("pushToRedoStack",r)},redo:function(e){var t=e.commit,n=e.state,o=e.getters,r=n.redoStack.pop();F.revertChange(t,o,r),t("pushToUndoStack",r)}},Q={state:J,getters:X,mutations:z,actions:H},W={tuning:["e","B","G","D","A","E"],tab:{sections:["0"]},sections:{0:{id:"0",bars:["0"]}},bars:{0:{id:"0",parentId:"0",beats:["0","1","2","3"]}},beats:{0:{id:"0",parentId:"0",notes:["0","1","2","3","4","5"]},1:{id:"1",parentId:"0",notes:["6","7","8","9","10","11"]},2:{id:"2",parentId:"0",notes:["12","13","14","15","16","17"]},3:{id:"3",parentId:"0",notes:["18","19","20","21","22","23"]}},notes:{0:{parentId:"0",id:"0",note:""},1:{id:"1",parentId:"0",note:""},2:{id:"2",parentId:"0",note:""},3:{id:"3",parentId:"0",note:""},4:{id:"4",parentId:"0",note:""},5:{id:"5",parentId:"0",note:""},6:{id:"6",parentId:"1",note:""},7:{id:"7",parentId:"1",note:""},8:{id:"8",parentId:"1",note:""},9:{id:"9",parentId:"1",note:""},10:{id:"10",parentId:"1",note:""},11:{id:"11",parentId:"1",note:""},12:{id:"12",parentId:"2",note:""},13:{id:"13",parentId:"2",note:""},14:{id:"14",parentId:"2",note:""},15:{id:"15",parentId:"2",note:""},16:{id:"16",parentId:"2",note:""},17:{id:"17",parentId:"2",note:""},18:{id:"18",parentId:"3",note:""},19:{id:"19",parentId:"3",note:""},20:{id:"20",parentId:"3",note:""},21:{id:"21",parentId:"3",note:""},22:{id:"22",parentId:"3",note:""},23:{id:"23",parentId:"3",note:""}}},Y={sections:function(e){return e.tab.sections.map(function(t){return e.sections[t]})},sectionIdViaTabIndex:function(e){return function(t){return e.tab.sections[t]}},sectionIndex:function(e){return function(t){return e.tab.sections.indexOf(t)}},sectionCount:function(e){return e.tab.sections.length},barsOfSection:function(e){return function(t){return e.sections[t].bars.map(function(t){return e.bars[t]})}},barIdViaSectionIndex:function(e){return function(t){return e.sections[t.parentId].bars[t.index]}},barParent:function(e){return function(t){var n=e.bars[t].parentId;return e.sections[n]}},barCountOfSection:function(e){return function(t){var n=e.sections[t].bars;return Object.keys(n).length}},isLastBar:function(e){return function(t){var n=e.bars[t].parentId,o=e.sections[n].bars;return o[o.length-1]===t}},beatsOfBar:function(e){return function(t){return e.bars[t].beats.map(function(t){return e.beats[t]})}},beat:function(e){return function(t){return e.beats[t]}},notesOfBeat:function(e){return function(t){return e.beats[t].notes.map(function(t){return e.notes[t]})}},note:function(e){return function(t){return e.notes[t]}}},Z={makeGUID:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})},createSection:function(e,t){var n=this.makeGUID();e.tab.sections.splice(t,0,n),o["a"].set(e.sections,n,{id:n,bars:[]});var r=this.makeGUID();this.createBar(e,r,n),e.sections[n].bars.push(r)},createBar:function(e,t,n){o["a"].set(e.bars,t,{id:t,parentId:n,beats:[]});while(e.bars[t].beats.length<4){var r=this.makeGUID();o["a"].set(e.beats,r,{id:r,parentId:t,notes:[]});while(e.beats[r].notes.length<6){var a=this.makeGUID();o["a"].set(e.notes,a,{id:a,parentId:r,note:""}),e.beats[r].notes.push(a)}e.bars[t].beats.push(r)}},deleteSection:function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,c=e.sections[t].bars[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var d=i.value;this.deleteBar(e,d)}}catch(e){r=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}o["a"].delete(e.sections,t)},deleteBar:function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,c=e.bars[t].beats[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var d=i.value,s=!0,u=!1,l=void 0;try{for(var f,p=e.beats[d].notes[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var b=f.value;o["a"].delete(e.notes,b)}}catch(e){u=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}o["a"].delete(e.beats,d)}}catch(e){r=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}o["a"].delete(e.bars,t)}},ee={addSection:function(e,t){Z.createSection(e,t)},addSectionReference:function(e,t){e.tab.sections.splice(t.index,0,t.sectionId)},removeSectionReference:function(e,t){e.tab.sections.splice(t,1)},deleteSection:function(e,t){Z.deleteSection(e,t)},addBar:function(e,t){var n=Z.makeGUID();e.sections[t.parentId].bars.splice(t.index,0,n),Z.createBar(e,n,t.parentId)},addBarReference:function(e,t){var n=e.sections[t.parentId].bars;n.splice(t.index,0,t.barId)},removeBarReference:function(e,t){var n=e.sections[t.parentId].bars;n.splice(t.index,1)},deleteBar:function(e,t){var n=e.bars[t].parentId,r=e.sections[n],a=r.bars.indexOf(t);o["a"].delete(r.bars,a),Z.deleteBar(e,t)},replaceNote:function(e,t){o["a"].set(e.notes[t.id],"note",t.value)}},te={namespaced:!0,state:W,getters:Y,mutations:ee,modules:{Editor:Q}};o["a"].use(S["a"]);var ne=new S["a"].Store({modules:{tab:te,editor:Q}});o["a"].config.productionTip=!1,new o["a"]({store:ne,render:function(e){return e(V)}}).$mount("#app")},"74f7":function(e,t,n){"use strict";var o=n("175c"),r=n.n(o);r.a},"781d":function(e,t,n){"use strict";var o=n("9436"),r=n.n(o);r.a},9436:function(e,t,n){},a9ff:function(e,t,n){},eafc:function(e,t,n){}});
//# sourceMappingURL=app.da2b8c47.js.map